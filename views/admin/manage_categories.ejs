<%- include('../partials/header') %>

<div style="min-height: 100vh; background: url('https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=1920&q=80') no-repeat center center fixed; background-size: cover; display: flex; justify-content: center; align-items: center; padding: 40px;">
  <div style="background: rgba(255, 255, 255, 0.96); padding: 30px 40px; border-radius: 14px; width: 100%; max-width: 800px; box-shadow: 0 8px 30px rgba(0,0,0,0.1);">

    <h2 style="text-align: center; color: #2c3e50; margin-bottom: 24px;">🗂️ Manage Ticket Categories</h2>

    <% if (typeof error !== 'undefined') { %>
      <div style="background-color: #ffe6e6; border-left: 5px solid #e74c3c; padding: 10px 16px; margin-bottom: 20px; color: #b30000; border-radius: 8px;">
        <%= error %>
      </div>
    <% } %>

    <!-- 🔍 Search -->
    <form method="GET" action="/admin/categories" style="margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
      <input
        type="text"
        name="search"
        placeholder="Search categories"
        value="<%= search || '' %>"
        style="flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 8px;"
      />
      <button type="submit" style="padding: 10px 18px; background-color: #3498db; color: white; border: none; border-radius: 8px; cursor: pointer;">Search</button>
    </form>

    <!-- ➕ Add Category -->
    <form action="/admin/categories" method="POST" style="margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
      <input
        type="text"
        name="name"
        placeholder="New Category Name"
        required
        style="flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 8px;"
      />
      <button type="submit" style="padding: 10px 18px; background-color: #2ecc71; color: white; border: none; border-radius: 8px; cursor: pointer;">Add Category</button>
    </form>

    <hr style="margin: 24px 0;" />

    <!-- 📃 List of Categories -->
    <% if (categories.length === 0) { %>
      <p style="text-align: center; color: #888;">No categories found.</p>
    <% } else { %>
      <ul style="list-style: none; padding-left: 0;">
        <% categories.forEach(cat => { %>
          <li style="margin-bottom: 12px; padding: 10px 14px; background-color: #f8f9fa; border: 1px solid #ddd; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
            <span><%= cat.name %></span>
            <form action="/admin/categories/delete/<%= cat._id %>" method="POST" style="margin: 0;">
              <button type="submit" style="padding: 6px 12px; background-color: #e74c3c; color: white; border: none; border-radius: 6px; cursor: pointer;">Delete</button>
            </form>
          </li>
        <% }) %>
      </ul>
    <% } %>

    <!-- 🔙 Back -->
    <div style="text-align: center; margin-top: 30px;">
      <a href="/admin/dashboard" style="text-decoration: none; background-color: #7f8c8d; color: white; padding: 10px 20px; border-radius: 8px; display: inline-block;">🔙 Back to Dashboard</a>
    </div>

  </div>
</div>

<%- include('../partials/footer') %>
